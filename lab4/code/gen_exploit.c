/* gen_exploit.c */

#include <stdlib.h>
#include <stdio.h>
#include <string.h>

int main(int argc, char **argv) {
	char buffer[40];
	FILE *exploit_file;

	exploit_file = fopen("./lab4file", "w");

	/* Place 3 addresses at offsets X, Y, and Z in lab4file.
		 A basic attack involves the address of the system function, a
		 string to pass to system(), and address of the exit() function. */
	*(long *) &buffer[0] = 0xABABABAB ;
	*(long *) &buffer[0] = 0xCDCDCDCD ;
	*(long *) &buffer[0] = 0xEFEFEFEF ;



	fwrite(buffer, sizeof(buffer), 1, exploit_file);

	buffer[0] = 0xAC;
	buffer[1] = 0xAC;
	buffer[2] = 0xAC;
	buffer[3] = 0xAC;

	fclose(exploit_file);
}
